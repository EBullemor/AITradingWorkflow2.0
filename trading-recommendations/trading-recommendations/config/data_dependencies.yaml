# ===========================================
# Data Dependencies
# ===========================================
# Maps features to their underlying data sources.
# Use this to understand what breaks if a data source fails.

data_sources:
  # ----- Bloomberg -----
  bloomberg:
    description: "Primary market data source"
    update_frequency: "daily"
    export_method: "manual_csv"  # or "api" if using Bloomberg API
    
    fields:
      PX_LAST:
        description: "Last traded price"
        used_by:
          - momentum_1m
          - momentum_3m
          - momentum_6m
          - momentum_zscore
          - realized_vol_30d
          - realized_vol_90d
          - atr_14
          
      PX_HIGH:
        description: "Daily high price"
        used_by:
          - atr_14
          
      PX_LOW:
        description: "Daily low price"
        used_by:
          - atr_14
          
      FWD_CURVE:
        description: "Forward points curve for FX"
        used_by:
          - fx_carry
          - fx_forward_points
          
      HIST_VOL_90D:
        description: "90-day historical volatility"
        used_by:
          - fx_carry
          
      # Commodities term structure
      CL1_COMDTY:
        description: "WTI front month"
        used_by:
          - roll_yield
          - ts_slope
          
      CL4_COMDTY:
        description: "WTI 4th month"
        used_by:
          - roll_yield
          - ts_slope
          
      GC1_COMDTY:
        description: "Gold front month"
        used_by:
          - roll_yield
          - ts_slope
          
      HG1_COMDTY:
        description: "Copper front month"
        used_by:
          - roll_yield
          - ts_slope
          
      # Macro
      VIX_INDEX:
        description: "CBOE Volatility Index"
        used_by:
          - vix_regime
          
      DXY_CURNCY:
        description: "US Dollar Index"
        used_by:
          - trend_regime

  # ----- Glassnode (BTC On-Chain) -----
  glassnode:
    description: "Bitcoin on-chain analytics"
    update_frequency: "daily"
    api_endpoint: "https://api.glassnode.com"
    requires_api_key: true
    enabled: false  # Set to true when API key configured
    
    fields:
      exchange_net_flow:
        description: "Net BTC flow to/from exchanges"
        used_by:
          - exchange_flow_zscore
        endpoint: "/v1/metrics/exchanges/net_position_change"
        
      mvrv_ratio:
        description: "Market Value to Realized Value"
        used_by:
          - mvrv_ratio
        endpoint: "/v1/metrics/market/mvrv"

  # ----- EIA (Energy Inventories) -----
  eia:
    description: "US Energy Information Administration"
    update_frequency: "weekly"
    api_endpoint: "https://api.eia.gov"
    
    fields:
      crude_inventory:
        description: "US commercial crude oil inventories"
        used_by:
          - inventory_zscore  # For commodities strategy
        series_id: "PET.WCESTUS1.W"

  # ----- CFTC (COT Data) -----
  cftc:
    description: "Commitment of Traders reports"
    update_frequency: "weekly"
    source: "https://www.cftc.gov/dea/futures/deacmesf.htm"
    
    fields:
      net_positioning:
        description: "Net speculative positioning"
        used_by:
          - positioning_zscore  # Future feature
        notes: "Released every Friday for Tuesday's data"

# ----- Dependency Graph -----
# Which strategies break if each source fails

impact_analysis:
  bloomberg:
    critical: true  # System cannot function without this
    affected_strategies:
      - fx_carry_momentum
      - btc_trend_vol
      - commodities_ts
      - cross_asset_risk
      - mean_reversion
    fallback: "None - halt trading"
    
  glassnode:
    critical: false
    affected_strategies:
      - btc_trend_vol  # Partial - on-chain features only
    fallback: "BTC strategy runs without on-chain confirmation"
    
  eia:
    critical: false
    affected_strategies:
      - commodities_ts  # Partial - inventory features only
    fallback: "Commodities strategy runs without inventory data"
